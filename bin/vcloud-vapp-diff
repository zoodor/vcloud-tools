#!/usr/bin/env ruby

require 'methadone'

require 'vcloud/vapp_diff'

class App
  include Methadone::Main
  include Methadone::CLILogging
  include Vcloud

  main do |vdc_name, vdc_config_dir|
    result = VappDiff.new.run(vdc_config_dir, vdc_name)
    options[:yaml] ? print(result.to_yaml)  :  print(JSON.pretty_generate result)

  end

  on("--yaml",   "Yaml output")

  arg :vdc_name
  arg :vdc_config_dir
  version Vcloud::VERSION

  description "
  vcloud-vapp-diff displays the differences between a vdc's vapp config (used by vcloud-launch) and the reality in the environment

  See https://github.com/alphagov/vcloud-tools for more info
  "

  go!
end
